# PyInstaller 打包脚本

## 功能概述

`pyinstaller_packager.py` 是项目的核心构建工具，负责将Python应用打包为单个可执行文件。

## 主要特性

### 🔧 自动依赖管理
- 自动检查并安装PyInstaller
- 可选安装UPX压缩工具
- 智能处理依赖冲突

### 📦 打包优化
- 单文件打包模式（--onefile）
- 控制台窗口显示（便于调试）
- 自动清理构建缓存
- 隐藏导入模块处理

### 🔢 版本管理
- 自动读取VERSION文件
- 嵌入版本信息到exe文件
- 生成MD5校验文件
- 文件大小验证

### 📁 资源管理
- 自动添加数据文件
- 支持requirements.txt打包
- 脚本目录资源打包
- 版本文件绑定

## 使用方法

### 基本使用
```bash
python scripts/pyinstaller_packager.py
```

### 构建输出
- **可执行文件**: `dist/local_agent.exe`
- **校验文件**: `dist/local_agent_md5.txt`
- **构建目录**: `build/`（临时文件）

## 参数说明

脚本支持以下功能参数（通过修改源码配置）：

### 打包配置
- `--name`: 输出文件名
- `--onefile`: 单文件模式
- `--console`: 控制台模式
- `--clean`: 清理缓存

### 资源添加
- `--add-data`: 添加数据文件
- `--hidden-import`: 隐藏导入模块

## 错误处理

### 常见问题
1. **权限错误**: 确保有文件写入权限
2. **依赖缺失**: 脚本会自动安装必要依赖
3. **版本冲突**: 检查Python版本兼容性

### 调试信息
- 详细的构建日志输出
- 文件大小验证
- 版本信息检查

## 集成说明

### 与项目集成
- 使用项目统一日志系统
- 支持相对路径引用
- 自动检测项目结构

### 版本控制
- 与VERSION文件同步
- 支持语义化版本号
- 文件校验机制